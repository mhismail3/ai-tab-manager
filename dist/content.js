(()=>{function t(){var t={title:document.title,description:"",keywords:[],textContent:"",headings:[],links:[]},e=document.querySelector('meta[name="description"]');e&&(t.description=e.getAttribute("content"));var n=document.querySelector('meta[name="keywords"]');if(n){var r=n.getAttribute("content");t.keywords=r?r.split(",").map((function(t){return t.trim()})):[]}var o=document.querySelectorAll("h1, h2, h3");t.headings=Array.from(o).map((function(t){return t.textContent.trim()})).filter(Boolean);var i=(document.querySelector("main")||document.querySelector("article")||document.body).querySelectorAll("p");t.textContent=Array.from(i).map((function(t){return t.textContent.trim()})).filter((function(t){return t.length>20})).slice(0,5).join(" ");var a=document.querySelectorAll("a[href]");return t.links=Array.from(a).map((function(t){return{href:t.href,text:t.textContent.trim()}})).filter((function(t){return t.href.startsWith("http")&&t.text&&t.text.length>0&&!t.href.includes("javascript:")})).slice(0,20),t}function e(){var e=t();chrome.runtime.sendMessage({action:"updatePageMetadata",data:{url:window.location.href,metadata:e,timestamp:Date.now()}})}window.addEventListener("load",(function(){setTimeout(e,1500)}));var n=window.location.href;new MutationObserver((function(){window.location.href!==n&&(n=window.location.href,setTimeout(e,1500))})).observe(document,{subtree:!0,childList:!0}),chrome.runtime.onMessage.addListener((function(e,n,r){if("getPageMetadata"===e.action){var o=t();r({success:!0,data:{url:window.location.href,metadata:o,timestamp:Date.now()}})}return!0}))})();